#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

echo "-----> Installing Ghostscript 10.01.2"

BUILD_DIR=$1
BUILD_DIR_BIN="$BUILD_DIR/bin"
BUILD_DIR_LIB="$BUILD_DIR/lib"
PACKAGE="https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs10012/ghostscript-10.01.2.tar.gz"
GS_BIN_PATH="$BUILD_DIR/ghostscript-10.01.2/bin"
GS_LIB_PATH="$BUILD_DIR/ghostscript-10.01.2/lib"

mkdir $BUILD_DIR_BIN $BUILD_DIR_LIB

echo "-----> Building runtime environment for Ghostscript"

cd $BUILD_DIR
curl -L -O $PACKAGE -s
tar zxvf ghostscript-10.01.2.tar.gz
cd ghostscript-10.01.2

./configure --disable-cups --disable-gtk --with-drivers=FILES
make
# Debug
ls
echo "Ghostscript version:"
bin/gs --version

mv $GS_BIN_PATH/* $BUILD_DIR_BIN/
mv $GS_LIB_PATH/* $BUILD_DIR_LIB/

#mkdir -p $BUILD_DIR/.profile.d
#echo "export PATH=\"\$BUILD_DIR_BIN:\$PATH\"" > $BUILD_DIR/.profile.d/ghostscript.sh
#cp $BUILD_DIR/.profile.d/ghostcript.sh ./export
